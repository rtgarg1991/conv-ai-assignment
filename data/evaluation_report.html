<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid RAG Evaluation Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #2ec4b6;
            --warning: #ff9f1c;
            --danger: #e63946;
            --bg: #f8f9fa;
            --card-bg: #ffffff;
            --text: #212529;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: var(--primary); margin-bottom: 0.5rem; }
        h2 { color: var(--secondary); margin: 2rem 0 1rem; border-bottom: 2px solid var(--primary); padding-bottom: 0.5rem; }
        h3 { color: var(--text); margin: 1.5rem 0 0.75rem; }
        .subtitle { color: #6c757d; margin-bottom: 2rem; }
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        .metric-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        .metric-value { font-size: 2.5rem; font-weight: bold; }
        .metric-label { font-size: 0.9rem; opacity: 0.9; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        th { background: var(--primary); color: white; }
        tr:hover { background: #f1f3f5; }
        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }
        .justification {
            background: #e7f5ff;
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 0.5rem 0;
        }
        .formula {
            font-family: 'Courier New', monospace;
            background: #f1f3f5;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            display: inline-block;
        }
        .success { color: var(--success); }
        .warning { color: var(--warning); }
        .danger { color: var(--danger); }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .badge-success { background: var(--success); color: white; }
        .badge-warning { background: var(--warning); color: white; }
        .badge-danger { background: var(--danger); color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Hybrid RAG System - Evaluation Report</h1>
        <p class="subtitle">Generated: 2026-02-07 18:35:10</p>
        
        
        <h2>üìä Performance Summary</h2>
        <div class="metric-grid">
            <div class="metric-card">
                <div class="metric-value">67.00%</div>
                <div class="metric-label">MRR (Retrieval)</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">7.12%</div>
                <div class="metric-label">ROUGE-L (Generation)</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">62.82%</div>
                <div class="metric-label">BERTScore (Semantic)</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">0.22s</div>
                <div class="metric-label">Avg Latency</div>
            </div>
        </div>
        <div class="card">
            <p><strong>Questions Evaluated:</strong> 100</p>
            <p><strong>Failed:</strong> 0</p>
            <p><strong>Total Processing Time:</strong> 22.1s</p>
        </div>
        
        
        <h2>üìê Metric Justifications</h2>
        <p>The following metrics were selected to evaluate different aspects of the RAG system:</p>
        
            <div class="card">
                <h3>Mean Reciprocal Rank (MRR)</h3>
                <div class="justification">
                    <strong>Why this metric?</strong>
                    <p>MRR is the mandatory metric for this assignment, measuring how quickly the system 
            identifies the correct source document. It's calculated at the URL level (not chunk level)
            to evaluate document-level retrieval accuracy. A high MRR indicates the system 
            consistently ranks relevant documents near the top of results.</p>
                </div>
                <p><strong>Formula:</strong></p>
                <p class="formula">MRR = (1/|Q|) √ó Œ£(1/rank_i) where rank_i is position of first relevant document</p>
                <p><strong>Interpretation:</strong></p>
                <pre>- MRR = 1.0: Perfect - correct document always ranked #1
            - MRR > 0.8: Excellent retrieval performance
            - MRR 0.5-0.8: Good, but room for improvement
            - MRR < 0.5: Needs significant improvement</pre>
            </div>
            
            <div class="card">
                <h3>ROUGE-L (Longest Common Subsequence)</h3>
                <div class="justification">
                    <strong>Why this metric?</strong>
                    <p>ROUGE-L measures the quality of generated answers by comparing them to reference answers.
            It captures the longest matching sequence of words, rewarding fluency and coherent structure.
            This is particularly valuable for RAG systems where answers should accurately reflect 
            the source content while maintaining readability.</p>
                </div>
                <p><strong>Formula:</strong></p>
                <p class="formula">ROUGE-L F1 = (2 √ó Precision √ó Recall) / (Precision + Recall)</p>
                <p><strong>Interpretation:</strong></p>
                <pre>- ROUGE-L > 0.5: Strong overlap with reference answers
            - ROUGE-L 0.3-0.5: Moderate overlap, captures key information
            - ROUGE-L < 0.3: Low overlap, may indicate answer quality issues</pre>
            </div>
            
            <div class="card">
                <h3>BERTScore (Semantic Similarity)</h3>
                <div class="justification">
                    <strong>Why this metric?</strong>
                    <p>BERTScore evaluates semantic similarity between generated and reference answers using
            contextual embeddings. Unlike ROUGE, it captures meaning rather than exact word matches,
            making it robust to paraphrasing. This is crucial for RAG systems that may generate
            semantically correct answers using different phrasing than the source.</p>
                </div>
                <p><strong>Formula:</strong></p>
                <p class="formula">BERTScore uses cosine similarity of BERT embeddings, aggregated across tokens</p>
                <p><strong>Interpretation:</strong></p>
                <pre>- BERTScore > 0.9: Excellent semantic alignment
            - BERTScore 0.7-0.9: Good semantic similarity
            - BERTScore < 0.7: May indicate semantic drift or hallucination</pre>
            </div>
            
        
        
        <h2>üî¨ Ablation Studies</h2>
        <p>Comparison of different retrieval methods:</p>
        <div class="card">
            <table>
                <thead>
                    <tr><th>Method</th><th>MRR</th></tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>sparse_only</td>
                <td><span class="badge badge-success">0.7190</span></td>
            </tr>
            
            <tr>
                <td>hybrid_sparse_heavy</td>
                <td><span class="badge badge-warning">0.6690</span></td>
            </tr>
            
            <tr>
                <td>hybrid_balanced</td>
                <td><span class="badge badge-warning">0.6640</span></td>
            </tr>
            
            <tr>
                <td>hybrid_k60</td>
                <td><span class="badge badge-warning">0.6640</span></td>
            </tr>
            
            <tr>
                <td>hybrid_dense_heavy</td>
                <td><span class="badge badge-warning">0.6583</span></td>
            </tr>
            
            <tr>
                <td>dense_only</td>
                <td><span class="badge badge-warning">0.6407</span></td>
            </tr>
            
                </tbody>
            </table>
            <div class="chart-container">
                <canvas id="ablationChart"></canvas>
            </div>
        </div>
        <div class="card">
            <h3>Analysis</h3>
            <p><strong>Best Method:</strong> sparse_only (MRR: 0.7190)</p>
            <p><strong>Hybrid vs Single Method Improvement:</strong> -7.0%</p>
            <p><strong>Recommendation:</strong> Use sparse_only for optimal performance</p>
        </div>
        
        
        <h2>üîç Error Analysis</h2>
        <div class="card">
            <p><strong>Success Rate:</strong> <span class="success">42.0%</span></p>
            <p><strong>Retrieval Accuracy:</strong> 84.0%</p>
            <table>
                <thead>
                    <tr><th>Category</th><th>Count</th><th>Percentage</th></tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>SUCCESS</td>
                <td>21</td>
                <td><span class="success">42.0%</span></td>
            </tr>
            
            <tr>
                <td>RANK_DEGRADED</td>
                <td>17</td>
                <td><span class="danger">34.0%</span></td>
            </tr>
            
            <tr>
                <td>RETRIEVAL_MISS</td>
                <td>8</td>
                <td><span class="warning">16.0%</span></td>
            </tr>
            
            <tr>
                <td>LOW_ANSWER_QUALITY</td>
                <td>4</td>
                <td><span class="warning">8.0%</span></td>
            </tr>
            
                </tbody>
            </table>
            <div class="chart-container">
                <canvas id="errorChart"></canvas>
            </div>
        </div>
        <div class="card">
            <h3>Recommendations</h3>
            <ul><li>RANK DEGRADATION: RRF weights may need tuning, or consider re-ranking model</li></ul>
        </div>
        
        
        <h2>‚ùì Question Type Distribution</h2>
        <div class="card">
            <table>
                <thead>
                    <tr><th>Question Type</th><th>Count</th></tr>
                </thead>
                <tbody>
                    <tr><td>comparative</td><td>26</td></tr><tr><td>factual</td><td>25</td></tr><tr><td>inferential</td><td>25</td></tr><tr><td>multi_hop</td><td>24</td></tr>
                </tbody>
            </table>
            <div class="chart-container">
                <canvas id="questionChart"></canvas>
            </div>
        </div>
        
        
        <h2>‚öôÔ∏è System Configuration</h2>
        <div class="card">
            <table>
                <tr><th>Parameter</th><th>Value</th></tr>
                <tr><td>Embedding Model</td><td>sentence-transformers/all-MiniLM-L6-v2</td></tr>
                <tr><td>Generation Model</td><td>google/flan-t5-base</td></tr>
                <tr><td>Top-N Retrieval</td><td>5</td></tr>
                <tr><td>RRF K Value</td><td>60</td></tr>
            </table>
        </div>
        
    </div>
    
    <script>

            new Chart(document.getElementById('ablationChart'), {
                type: 'bar',
                data: {
                    labels: ["dense_only", "sparse_only", "hybrid_balanced", "hybrid_dense_heavy", "hybrid_sparse_heavy", "hybrid_k60"],
                    datasets: [{
                        label: 'MRR Score',
                        data: [0.6407, 0.719, 0.664, 0.6583, 0.669, 0.664],
                        backgroundColor: ['#4361ee', '#3f37c9', '#7209b7', '#f72585', '#4cc9f0']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 1 } }
                }
            });
            

            new Chart(document.getElementById('errorChart'), {
                type: 'doughnut',
                data: {
                    labels: ["SUCCESS", "RANK_DEGRADED", "RETRIEVAL_MISS", "LOW_ANSWER_QUALITY"],
                    datasets: [{
                        data: [21, 17, 8, 4],
                        backgroundColor: ['#2ec4b6', '#ff9f1c', '#e63946', '#4361ee']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
</script>
</body>
</html>